<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suriye Mirası - Dijital Rehber</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;700&family=Noto+Sans:wght@400;500;600;700&family=Noto+Serif:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- SUPABASE JS CLIENT -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#b45309', 
                        secondary: '#1f2937', 
                        light: '#f3f4f6',
                        offwhite: '#fcfcfc',
                    },
                    fontFamily: {
                        sans: ['"Noto Sans"', 'sans-serif'],
                        serif: ['"Noto Serif"', 'serif'],
                        arabic: ['"Noto Naskh Arabic"', 'serif'],
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'card': '0 0 0 1px rgba(0,0,0,0.03), 0 2px 8px rgba(0,0,0,0.04)',
                    },
                    zIndex: {
                        '60': '60',
                        '70': '70',
                        '80': '80',
                        '90': '90',
                        '100': '100',
                    }
                }
            }
        }
    </script>

    <style>
        /* RTL ve Font Ayarları */
        :root {
            --font-main: 'Noto Sans', sans-serif;
        }
        body {
            font-family: var(--font-main);
        }
        [dir="rtl"] body {
            font-family: 'Noto Naskh Arabic', serif;
        }
        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        audio {
            outline: none;
        }
        audio::-webkit-media-controls-panel {
            background-color: #f3f4f6;
        }
        .detail-content p {
            margin-bottom: 1.25rem;
            line-height: 1.8;
        }
        .pattern-bg {
            background-color: #b45309;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        #mobile-menu {
            transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        #mobile-menu.open {
            max-height: 500px;
            opacity: 1;
        }
        #map-container {
            height: calc(100vh - 180px);
            min-height: 500px;
            z-index: 1; 
            position: relative;
        }
        .leaflet-popup-content-wrapper {
            border-radius: 0.75rem;
            overflow: hidden;
            padding: 0;
        }
        .leaflet-popup-content {
            margin: 0;
            width: 280px !important;
        }
        /* Leaflet Image Fix */
        .leaflet-pane img {
            max-width: none !important;
        }
        .lightbox-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0,0,0,0.5);
            color: white;
            padding: 1rem;
            border-radius: 50%;
            cursor: pointer;
            z-index: 100;
            transition: background-color 0.3s;
            border: none;
            outline: none;
            width: 3rem;
            height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .lightbox-nav-btn:hover {
            background-color: rgba(255,255,255,0.2);
        }
    </style>
</head>
<body class="bg-offwhite text-gray-800 min-h-screen flex flex-col transition-all duration-300">

    <!-- Navbar -->
    <nav class="bg-white shadow-sm sticky top-0 z-50 border-b border-gray-200">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center h-20">
                
                <!-- Logo Section -->
                <div class="flex items-center space-x-3 rtl:space-x-reverse cursor-pointer group flex-shrink-0" onclick="router('home')">
                    <!-- Bayrak Görseli -->
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5b/Emblem_of_Syria_%282025%E2%80%93present%29.svg/2560px-Emblem_of_Syria_%282025%E2%80%93present%29.svg.png" 
                         class="w-10 h-10 object-contain group-hover:scale-105 transition duration-300" 
                         alt="Site Logo">
                    
                    <div class="flex flex-col">
                        <h1 class="font-bold text-xl leading-none text-gray-900 tracking-tight uppercase" id="nav-title">SURİYE MİRASI</h1>
                        <p class="text-xs text-gray-500 font-medium mt-0.5 tracking-wide uppercase" id="nav-subtitle">DİJİTAL REHBER</p>
                    </div>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-1 rtl:space-x-reverse">
                    <button onclick="router('home')" class="px-4 py-2 text-sm font-semibold text-gray-700 hover:text-primary hover:bg-gray-50 rounded-lg transition" id="menu-home">Anasayfa</button>
                    <button onclick="router('map')" class="px-4 py-2 text-sm font-semibold text-gray-700 hover:text-primary hover:bg-gray-50 rounded-lg transition" id="menu-map">Harita</button>
                    <button onclick="openModal('about')" class="px-4 py-2 text-sm font-semibold text-gray-700 hover:text-primary hover:bg-gray-50 rounded-lg transition" id="menu-about">Hakkımızda</button>
                    <button onclick="openModal('contact')" class="px-4 py-2 text-sm font-semibold text-gray-700 hover:text-primary hover:bg-gray-50 rounded-lg transition" id="menu-contact">İletişim</button>
                    
                    <div class="h-6 w-px bg-gray-200 mx-2"></div> <!-- Separator -->

                    <!-- Language Selector -->
                    <div class="relative group">
                        <button class="flex items-center gap-2 text-sm font-bold text-gray-600 hover:text-primary transition py-2 px-3 rounded-full hover:bg-gray-50 border border-transparent hover:border-gray-100">
                            <img id="current-lang-flag" src="https://flagcdn.com/w40/tr.png" class="w-6 h-6 rounded-full object-cover border border-gray-200 shadow-sm" alt="TR">
                            <span id="current-lang-label" class="hidden lg:inline">TR</span>
                            <i class="fa-solid fa-chevron-down text-xs ml-1 text-gray-400"></i>
                        </button>
                        
                        <div class="absolute right-0 top-full pt-2 w-48 hidden group-hover:block rtl:right-auto rtl:left-0 z-50">
                            <div class="bg-white rounded-xl shadow-xl py-2 border border-gray-100 overflow-hidden ring-1 ring-black ring-opacity-5">
                                <button onclick="setLanguage('tr')" class="w-full text-left rtl:text-right px-4 py-2.5 text-sm hover:bg-gray-50 text-gray-700 font-medium flex items-center gap-3 group/item">
                                    <img src="https://flagcdn.com/w40/tr.png" class="w-5 h-5 rounded-full border border-gray-200 shadow-sm group-hover/item:scale-110 transition"> Türkçe
                                </button>
                                <button onclick="setLanguage('en')" class="w-full text-left rtl:text-right px-4 py-2.5 text-sm hover:bg-gray-50 text-gray-700 font-medium flex items-center gap-3 group/item">
                                    <img src="https://flagcdn.com/w40/gb.png" class="w-5 h-5 rounded-full border border-gray-200 shadow-sm group-hover/item:scale-110 transition"> English
                                </button>
                                <button onclick="setLanguage('ar')" class="w-full text-left rtl:text-right px-4 py-2.5 text-sm hover:bg-gray-50 text-gray-700 font-medium font-arabic flex items-center gap-3 group/item">
                                    <img src="https://flagcdn.com/w40/sy.png" class="w-5 h-5 rounded-full border border-gray-200 shadow-sm group-hover/item:scale-110 transition"> العربية
                                </button>
                                <button onclick="setLanguage('fr')" class="w-full text-left rtl:text-right px-4 py-2.5 text-sm hover:bg-gray-50 text-gray-700 font-medium flex items-center gap-3 group/item">
                                    <img src="https://flagcdn.com/w40/fr.png" class="w-5 h-5 rounded-full border border-gray-200 shadow-sm group-hover/item:scale-110 transition"> Français
                                </button>
                                <button onclick="setLanguage('ru')" class="w-full text-left rtl:text-right px-4 py-2.5 text-sm hover:bg-gray-50 text-gray-700 font-medium flex items-center gap-3 group/item">
                                    <img src="https://flagcdn.com/w40/ru.png" class="w-5 h-5 rounded-full border border-gray-200 shadow-sm group-hover/item:scale-110 transition"> Русский
                                </button>
                                <button onclick="setLanguage('osm')" class="w-full text-left rtl:text-right px-4 py-2.5 text-sm hover:bg-gray-50 text-gray-700 font-medium font-arabic flex items-center gap-3 group/item">
                                    <img src="https://www.tabloshop.com/image/cache/webp/data/urun/osmanli-oryantal-tablolar/OS-47__model_3-1000x1000.webp" class="w-5 h-5 rounded-full border border-gray-200 shadow-sm group-hover/item:scale-110 transition bg-white" alt="Osmanlı Arması"> عثمانليجه
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden flex items-center">
                    <button onclick="toggleMobileMenu()" class="text-gray-600 hover:text-primary focus:outline-none p-2">
                        <i class="fa-solid fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden bg-white border-t border-gray-100">
            <div class="px-4 py-3 space-y-2">
                <button onclick="router('home'); toggleMobileMenu()" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary hover:bg-gray-50" id="mobile-menu-home">Anasayfa</button>
                <button onclick="router('map'); toggleMobileMenu()" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary hover:bg-gray-50" id="mobile-menu-map">Harita</button>
                <button onclick="openModal('about'); toggleMobileMenu()" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary hover:bg-gray-50" id="mobile-menu-about">Hakkımızda</button>
                <button onclick="openModal('contact'); toggleMobileMenu()" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary hover:bg-gray-50" id="mobile-menu-contact">İletişim</button>
                
                <!-- Mobilde Dil Seçenekleri -->
                <div class="border-t border-gray-100 pt-2 mt-2">
                    <p class="px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">Dil Seçimi / Language</p>
                    <div class="grid grid-cols-2 gap-2 px-3 pb-2">
                         <button onclick="setLanguage('tr'); toggleMobileMenu()" class="flex items-center space-x-2 p-2 rounded-md hover:bg-gray-50 border border-gray-100">
                            <img src="https://flagcdn.com/w40/tr.png" class="w-5 h-5 rounded-full border border-gray-200" alt="TR">
                            <span class="text-sm font-medium text-gray-700">Türkçe</span>
                        </button>
                         <button onclick="setLanguage('en'); toggleMobileMenu()" class="flex items-center space-x-2 p-2 rounded-md hover:bg-gray-50 border border-gray-100">
                            <img src="https://flagcdn.com/w40/gb.png" class="w-5 h-5 rounded-full border border-gray-200" alt="EN">
                            <span class="text-sm font-medium text-gray-700">English</span>
                        </button>
                        <button onclick="setLanguage('ar'); toggleMobileMenu()" class="flex items-center space-x-2 p-2 rounded-md hover:bg-gray-50 border border-gray-100">
                            <img src="https://flagcdn.com/w40/sy.png" class="w-5 h-5 rounded-full border border-gray-200" alt="AR">
                            <span class="text-sm font-medium text-gray-700 font-arabic">العربية</span>
                        </button>
                        <button onclick="setLanguage('fr'); toggleMobileMenu()" class="flex items-center space-x-2 p-2 rounded-md hover:bg-gray-50 border border-gray-100">
                            <img src="https://flagcdn.com/w40/fr.png" class="w-5 h-5 rounded-full border border-gray-200" alt="FR">
                            <span class="text-sm font-medium text-gray-700">Français</span>
                        </button>
                        <button onclick="setLanguage('ru'); toggleMobileMenu()" class="flex items-center space-x-2 p-2 rounded-md hover:bg-gray-50 border border-gray-100">
                            <img src="https://flagcdn.com/w40/ru.png" class="w-5 h-5 rounded-full border border-gray-200" alt="RU">
                            <span class="text-sm font-medium text-gray-700">Русский</span>
                        </button>
                        <button onclick="setLanguage('osm'); toggleMobileMenu()" class="flex items-center space-x-2 p-2 rounded-md hover:bg-gray-50 border border-gray-100">
                            <img src="https://www.tabloshop.com/image/cache/webp/data/urun/osmanli-oryantal-tablolar/OS-47__model_3-1000x1000.webp" class="w-5 h-5 rounded-full border border-gray-200" alt="OSM">
                            <span class="text-sm font-medium text-gray-700 font-arabic">عثمانليجه</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="app" class="flex-grow container mx-auto px-4 py-8">
        <!-- İçerik buraya JavaScript ile yüklenecek -->
    </main>

    <!-- Lightbox (Büyük Resim Görüntüleyici) -->
    <div id="lightbox" class="fixed inset-0 z-[100] hidden bg-black/95 backdrop-blur-md flex items-center justify-center p-4 transition-opacity duration-300 opacity-0" onclick="closeLightbox(event)">
        <!-- Kapat Butonu -->
        <button class="absolute top-4 right-4 text-white hover:text-gray-300 z-[110] p-2 bg-black/50 rounded-full w-10 h-10 flex items-center justify-center" onclick="closeLightbox()">
            <i class="fa-solid fa-times text-xl"></i>
        </button>
        
        <!-- Sol Ok -->
        <button id="lightbox-prev" class="lightbox-nav-btn left-4" onclick="prevImage(event)">
            <i class="fa-solid fa-chevron-left text-xl"></i>
        </button>

        <!-- Resim -->
        <img id="lightbox-img" src="" alt="Büyük Resim" class="max-w-full max-h-[90vh] rounded-lg shadow-2xl transform transition-transform duration-300 select-none">

        <!-- Sağ Ok -->
        <button id="lightbox-next" class="lightbox-nav-btn right-4" onclick="nextImage(event)">
            <i class="fa-solid fa-chevron-right text-xl"></i>
        </button>
    </div>

    <!-- Modal (About/Contact) -->
    <div id="infoModal" class="fixed inset-0 bg-black/50 z-[60] hidden flex items-center justify-center p-4 backdrop-blur-sm transition-opacity duration-300">
        <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300" id="modalContent">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4 border-b border-gray-100 pb-2">
                    <h3 class="text-2xl font-bold text-gray-800" id="modalTitle">Başlık</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-red-500 transition p-1">
                        <i class="fa-solid fa-times text-xl"></i>
                    </button>
                </div>
                <div class="text-gray-600 leading-relaxed" id="modalBody">
                    <!-- İçerik -->
                </div>
                <div class="mt-6 text-right">
                    <button onclick="closeModal()" class="bg-gray-100 text-gray-700 px-5 py-2 rounded-lg hover:bg-gray-200 transition font-medium">Kapat</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 py-8 mt-auto">
        <div class="container mx-auto px-4 text-center">
             <div class="flex justify-center items-center space-x-2 mb-4 text-primary opacity-80">
                <!-- Footer Logo -->
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5b/Emblem_of_Syria_%282025%E2%80%93present%29.svg/2560px-Emblem_of_Syria_%282025%E2%80%93present%29.svg.png" 
                     class="w-12 h-12 object-contain" 
                     alt="Site Logo">
            </div>
            <p class="text-sm text-gray-500 font-medium mb-2" id="footer-text">© 2025 Suriye Mirası Projesi. Tüm hakları saklıdır.</p>
            <p class="text-xs text-gray-400 font-bold tracking-widest mt-2 flex justify-center items-center gap-1">
                ITT <i class="fa-solid fa-heart text-red-500 text-[10px]"></i> 2025
            </p>
        </div>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- GLOBAL DEĞİŞKENLER (window objesi üzerinden) ---
        window.currentLang = 'tr';
        window.currentView = 'home';
        window.currentPlaceId = null;
        window.db = [];
        window.currentGalleryImages = [];
        window.currentImageIndex = 0;
        window.map = null; // Harita objesi için global değişken

        // --- SUPABASE KONFİGÜRASYONU ---
        const SUPABASE_URL = "https://kmgbjztsouolzarimebc.supabase.co"; 
        const SUPABASE_ANON_KEY = "sb_publishable_jZQ1O8C1UglGdrL-28Axfg_erTIuO-L";

        let supabaseClient = null; 
        if (SUPABASE_URL && SUPABASE_ANON_KEY) {
            supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        } else {
            console.warn("UYARI: Supabase URL veya Anon Key eksik!");
        }

        // --- GÜVENLİ MAP URL DÖNÜŞTÜRÜCÜ ---
        function formatMapUrl(rawUrl) {
            if (!rawUrl) return "";
            if (rawUrl.includes("output=embed")) return rawUrl;
            
            const coordsMatch = rawUrl.match(/(-?\d+(\.\d+)?),\s*(-?\d+(\.\d+)?)/);
            if (coordsMatch) {
                const lat = coordsMatch[1];
                const lng = coordsMatch[3];
                return `https://maps.google.com/maps?q=${lat},${lng}&hl=tr&z=17&output=embed`;
            }
            return rawUrl;
        }

        // --- YENİ: AKILLI URL TEMİZLEME ---
        function cleanUrl(url) {
            if (!url) return null;
            let str = String(url).trim();
            
            const markdownMatch = str.match(/\((https?:\/\/[^\)]+)\)/);
            if (markdownMatch) {
                return markdownMatch[1];
            }
            
            if ((str.startsWith("['") || str.startsWith('["')) && (str.endsWith("']") || str.endsWith('"]'))) {
                 return str.slice(2, -2);
            }
            
            str = str.replace(/^['"]|['"]$/g, '');

            if (str.startsWith('http')) return str;
            
            return null;
        }

        // --- UI TEXT TRANSLATIONS ---
        const uiText = {
            tr: { 
                siteName: "SURİYE MİRASI", siteSubtitle: "DİJİTAL REHBER", searchPlaceholder: "Mekan, şehir veya eser arayın...", homeTitle: "Suriye'nin Kültürel Mirası", homeSubtitle: "Geçmişin izlerini, tarihi yapıları ve kültürel zenginlikleri dijital arşivimizde keşfedin.", readMore: "Detaylı İncele", back: "Geri Dön", gallery: "Galeri", location: "Konum", playAudio: "Sesli Anlatım", menuHome: "Anasayfa", menuMap: "Harita", menuAbout: "Hakkımızda", menuContact: "İletişim", aboutTitle: "Hakkımızda", aboutBody: "Suriye Mirası Projesi, bölgenin zengin tarihsel ve kültürel dokusunu dijital ortama taşıyarak gelecek nesillere aktarmayı hedefleyen bir girişimdir.", contactTitle: "İletişim", contactBody: "Görüş, öneri ve katkılarınız için bize ulaşabilirsiniz:<br><br><strong>E-posta:</strong> info@suriyemirasi.org"
            },
            en: { 
                siteName: "SYRIAN HERITAGE", siteSubtitle: "DIGITAL GUIDE", searchPlaceholder: "Search for places...", homeTitle: "Cultural Heritage of Syria", homeSubtitle: "Discover the traces of the past in our digital archive.", readMore: "Explore Detail", back: "Go Back", gallery: "Gallery", location: "Location", playAudio: "Audio Guide", menuHome: "Home", menuMap: "Map", menuAbout: "About Us", menuContact: "Contact", aboutTitle: "About Us", aboutBody: "The Syrian Heritage Project is an initiative aiming to transfer the region's rich historical and cultural texture to the digital environment.", contactTitle: "Contact", contactBody: "Contact us at: info@suriyemirasi.org"
            },
            ar: { 
                siteName: "التراث السوري", siteSubtitle: "الدليل الرقمي", searchPlaceholder: "ابحث عن الأماكن...", homeTitle: "التراث الثقافي السوري", homeSubtitle: "اكتشف آثار الماضي في أرشيفنا الرقمي.", readMore: "اكتشف التفاصيل", back: "رجوع", gallery: "معرض الصور", location: "الموقع", playAudio: "الدليل الصوتي", menuHome: "الرئيسية", menuMap: "خريطة", menuAbout: "من نحن", menuContact: "اتصل بنا", aboutTitle: "من نحن", aboutBody: "مشروع التراث السوري هو مبادرة تهدف إلى نقل النسيج التاريخي والثقافي الغني للمنطقة إلى البيئة الرقمية.", contactTitle: "اتصل بنا", contactBody: "اتصل بنا: info@suriyemirasi.org"
            },
            fr: { siteName: "PATRIMOINE SYRIEN", siteSubtitle: "GUIDE NUMÉRIQUE", searchPlaceholder: "Rechercher...", homeTitle: "Patrimoine Culturel", homeSubtitle: "Découvrez les traces du passé.", readMore: "Explorer", back: "Retour", gallery: "Galerie", location: "Lieu", playAudio: "Guide Audio", menuHome: "Accueil", menuMap: "Carte", menuAbout: "À Propos", menuContact: "Contact", aboutTitle: "À Propos", aboutBody: "Projet du patrimoine syrien.", contactTitle: "Contact", contactBody: "Email: info@suriyemirasi.org" },
            ru: { siteName: "СИРИЙСКОЕ НАСЛЕДИЕ", siteSubtitle: "ЦИФРОВОЙ ГИД", searchPlaceholder: "Поиск...", homeTitle: "Культурное наследие", homeSubtitle: "Откройте для себя следы прошлого.", readMore: "Подробнее", back: "Назад", gallery: "Галерея", location: "Местоположение", playAudio: "Аудиогид", menuHome: "Главная", menuMap: "Карта", menuAbout: "О нас", menuContact: "Контакты", aboutTitle: "О нас", aboutBody: "Проект Сирийское наследие.", contactTitle: "Контакты", contactBody: "Email: info@suriyemirasi.org" },
            osm: { siteName: "سوريه ميراثي", siteSubtitle: "ديجيتال رهبر", searchPlaceholder: "آرامق...", homeTitle: "سوريه‌نك ثقافت ميراثي", homeSubtitle: "ماضينك ايزلريني كشف ايدك.", readMore: "تفصيلاتلي تدقيق", back: "كرو دون", gallery: "رسملر", location: "موقع", playAudio: "صوتي شرح", menuHome: "آنا صفحه", menuMap: "خريطه", menuAbout: "حقيمزده", menuContact: "مخابره", aboutTitle: "حقيمزده", aboutBody: "سوريه ميراثي پروژه‌سي.", contactTitle: "مخابره", contactBody: "ا-پوسته: info@suriyemirasi.org" }
        };

        const flags = {
            tr: "https://flagcdn.com/w40/tr.png",
            en: "https://flagcdn.com/w40/gb.png",
            ar: "https://flagcdn.com/w40/sy.png",
            fr: "https://flagcdn.com/w40/fr.png",
            ru: "https://flagcdn.com/w40/ru.png",
            osm: "https://www.tabloshop.com/image/cache/webp/data/urun/osmanli-oryantal-tablolar/OS-47__model_3-1000x1000.webp"
        };

        // --- FALLBACK DB ---
        const fallbackDB = [
            // Boş
        ];

        // --- INITIALIZATION ---
        window.onload = async function() {
            await initApp();
        };

        // --- DATA FETCHING & INIT ---
        async function initApp() {
            let useFallback = true;
            if (supabaseClient) { 
                try {
                    const { data, error } = await supabaseClient 
                        .from('mekanlar')
                        .select('*')
                        .order('id', { ascending: true });

                    if (!error && data && data.length > 0) {
                        useFallback = false;
                        console.log("Veri çekildi:", data);
                        
                        window.db = data.map(item => {
                            // GÖRSEL LİNK İŞLEME
                            let rawImages = item.images;
                            let processedImages = [];
                            if (Array.isArray(rawImages)) { processedImages = rawImages; } 
                            else if (typeof rawImages === 'string') {
                                rawImages = rawImages.trim();
                                if (rawImages.startsWith('[') && rawImages.endsWith(']')) {
                                    try { processedImages = JSON.parse(rawImages); } 
                                    catch (e) { processedImages = rawImages.slice(1, -1).split(',').map(s => s.trim().replace(/^['"]|['"]$/g, '')); }
                                } else { processedImages = [rawImages]; }
                            }
                            processedImages = processedImages.map(img => cleanUrl(img)).filter(img => img !== null);
                            if (processedImages.length === 0) processedImages.push("https://via.placeholder.com/800x600?text=Gorsel+Yok");

                            return {
                                id: item.id,
                                coords: [item.lat, item.lng],
                                mapUrl: formatMapUrl(item.map_url),
                                images: processedImages,
                                content: {
                                    tr: { name: item.isim_tr, location: "Suriye", desc: item.aciklama_tr, detailDesc: item.detay_tr, audioTitle: "Sesli Rehber", audioUrl: cleanUrl(item.ses_tr) },
                                    en: { name: item.isim_en, location: "Syria", desc: item.aciklama_en, detailDesc: item.detay_en, audioTitle: "Audio Guide", audioUrl: cleanUrl(item.ses_en) },
                                    ar: { name: item.isim_ar, location: "سوريا", desc: item.aciklama_ar, detailDesc: item.detay_ar, audioTitle: "الدليل الصوتي", audioUrl: cleanUrl(item.ses_ar) },
                                    fr: { name: item.isim_fr || item.isim_en, location: "Syrie", desc: item.aciklama_fr || item.aciklama_en, detailDesc: item.detay_fr, audioTitle: "Guide Audio", audioUrl: cleanUrl(item.ses_fr) },
                                    ru: { name: item.isim_ru || item.isim_en, location: "Сирия", desc: item.aciklama_ru || item.aciklama_en, detailDesc: item.detay_ru, audioTitle: "Аудиогид", audioUrl: cleanUrl(item.ses_ru) },
                                    osm: { name: item.isim_osm || item.isim_tr, location: "سوريه", desc: item.aciklama_osm || item.aciklama_tr, detailDesc: item.detay_osm, audioTitle: "صوتي رهبر", audioUrl: cleanUrl(item.ses_osm) }
                                }
                            };
                        });
                    } else {
                        console.warn("Supabase verisi boş veya hata var:", error);
                    }
                } catch (err) {
                    console.error("Supabase bağlantı hatası:", err);
                }
            }

            if (useFallback) {
                window.db = fallbackDB;
            }

            const urlParams = new URLSearchParams(window.location.search);
            const idParam = urlParams.get('id');
            const viewParam = urlParams.get('view');

            if (idParam) {
                renderDetail(parseInt(idParam));
            } else if (viewParam === 'map') {
                renderMap();
            } else {
                renderHome();
            }
            updateUIText();
        }

        // --- ROUTING / NAVIGATION ---
        function router(view, id = null) {
            window.currentView = view;
            window.currentPlaceId = id;
            window.scrollTo(0, 0);

            try {
                const url = new URL(window.location);
                if (view === 'home') {
                    url.search = '';
                } else if (view === 'detail' && id) {
                    url.searchParams.set('id', id);
                } else if (view === 'map') {
                    url.searchParams.set('view', 'map');
                    url.searchParams.delete('id');
                }
                window.history.pushState({}, '', url);
            } catch (e) {}

            if (view === 'home') renderHome();
            else if (view === 'detail' && id) renderDetail(id);
            else if (view === 'map') renderMap();
        }

        window.onpopstate = function(event) {
            const urlParams = new URLSearchParams(window.location.search);
            const idParam = urlParams.get('id');
            const viewParam = urlParams.get('view');

            if (idParam) renderDetail(parseInt(idParam));
            else if (viewParam === 'map') renderMap();
            else renderHome();
        };

        // --- MOBILE MENU & MODAL & LIGHTBOX FUNCTIONS ---
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            if (menu.classList.contains('open')) menu.classList.remove('open'); else menu.classList.add('open');
        }

        function openModal(type) {
            const modal = document.getElementById('infoModal');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');
            const texts = uiText[window.currentLang];

            if (type === 'about') { title.innerText = texts.aboutTitle; body.innerHTML = texts.aboutBody; }
            else if (type === 'contact') { title.innerText = texts.contactTitle; body.innerHTML = texts.contactBody; }
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                document.getElementById('modalContent').classList.remove('scale-95');
                document.getElementById('modalContent').classList.add('scale-100');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('infoModal');
            modal.classList.add('opacity-0');
            document.getElementById('modalContent').classList.remove('scale-100');
            document.getElementById('modalContent').classList.add('scale-95');
            setTimeout(() => { modal.classList.add('hidden'); }, 300);
        }

        // --- LIGHTBOX FUNCTIONS (GÜNCELLENDİ) ---
        function openLightbox(index, images) {
            if (images) {
                window.currentGalleryImages = images;
            } else {
                if (window.currentGalleryImages.length === 0) return;
            }
            
            window.currentImageIndex = index;
            updateLightboxImage();
            
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('hidden');
            setTimeout(() => {
                lightbox.classList.remove('opacity-0');
            }, 10);
        }

        function updateLightboxImage() {
            const img = document.getElementById('lightbox-img');
            img.src = window.currentGalleryImages[window.currentImageIndex];
        }

        function closeLightbox(e) {
            if (e && e.target.id !== 'lightbox' && !e.target.closest('button')) return;
            
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.add('opacity-0');
            setTimeout(() => {
                lightbox.classList.add('hidden');
                document.getElementById('lightbox-img').src = "";
            }, 300);
        }
        
        function forceCloseLightbox() {
             const lightbox = document.getElementById('lightbox');
            lightbox.classList.add('opacity-0');
            setTimeout(() => {
                lightbox.classList.add('hidden');
            }, 300);
        }

        function nextImage(e) {
            if(e) e.stopPropagation();
            window.currentImageIndex = (window.currentImageIndex + 1) % window.currentGalleryImages.length;
            updateLightboxImage();
        }

        function prevImage(e) {
            if(e) e.stopPropagation();
            window.currentImageIndex = (window.currentImageIndex - 1 + window.currentGalleryImages.length) % window.currentGalleryImages.length;
            updateLightboxImage();
        }

        document.addEventListener('keydown', function(e) {
            const lightbox = document.getElementById('lightbox');
            if (lightbox.classList.contains('hidden')) return;

            if (e.key === 'Escape') forceCloseLightbox();
            if (e.key === 'ArrowRight') nextImage();
            if (e.key === 'ArrowLeft') prevImage();
        });

        window.onclick = function(event) {
            if (event.target == document.getElementById('infoModal')) closeModal();
        }

        // --- RENDER FUNCTIONS ---
        function renderHome() {
            if (window.map && window.map.remove) { window.map.remove(); window.map = null; }

            const app = document.getElementById('app');
            const texts = uiText[window.currentLang];
            const isRTL = (window.currentLang === 'ar' || window.currentLang === 'osm');

            let html = `
                <div class="relative pattern-bg rounded-3xl mb-12 shadow-xl overflow-hidden fade-in mx-2 lg:mx-0">
                    <div class="absolute inset-0 bg-black/10"></div>
                    <div class="relative z-10 px-6 py-16 md:py-24 text-center">
                        <h2 class="text-3xl md:text-5xl font-bold mb-4 text-white tracking-tight drop-shadow-sm leading-tight">${texts.homeTitle}</h2>
                        <p class="text-white/90 text-lg md:text-xl max-w-2xl mx-auto mb-10 font-medium leading-relaxed">${texts.homeSubtitle}</p>
                        <div class="max-w-2xl mx-auto relative group">
                            <div class="absolute inset-0 bg-white/20 blur-xl rounded-full transform group-hover:bg-white/30 transition duration-500"></div>
                            <div class="relative">
                                <input type="text" id="searchInput" onkeyup="filterPlaces()" 
                                    placeholder="${texts.searchPlaceholder}" 
                                    class="w-full py-5 px-8 rounded-full shadow-2xl text-gray-800 placeholder-gray-400 focus:ring-4 focus:ring-white/30 border-0 outline-none pl-14 rtl:pl-8 rtl:pr-14 transition-all duration-300 text-lg font-medium">
                                <i class="fa-solid fa-magnifying-glass absolute top-1/2 transform -translate-y-1/2 text-gray-400 left-6 rtl:left-auto rtl:right-6 text-xl group-hover:text-primary transition-colors"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 px-2 lg:px-0" id="placesGrid">
            `;

            window.db.forEach(place => {
                const content = place.content[window.currentLang] || place.content['tr']; 
                html += `
                    <div class="bg-white rounded-2xl shadow-card hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1.5 cursor-pointer group flex flex-col h-full overflow-hidden border border-gray-100/50 card-item" onclick="router('detail', ${place.id})">
                        <div class="h-60 overflow-hidden relative">
                            <img src="${place.images[0]}" onerror="this.src='https://via.placeholder.com/800x600?text=Gorsel+Yok'" referrerpolicy="no-referrer" alt="${content.name}" class="w-full h-full object-cover group-hover:scale-105 transition duration-700 ease-in-out">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-60 group-hover:opacity-40 transition-opacity"></div>
                            <div class="absolute top-4 left-4 bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full shadow-sm">
                                <span class="text-primary text-xs font-bold uppercase tracking-wider flex items-center gap-1"><i class="fa-solid fa-location-dot"></i> ${content.location}</span>
                            </div>
                        </div>
                        <div class="p-6 flex flex-col flex-grow relative">
                            <h3 class="text-xl font-bold mb-3 text-gray-800 group-hover:text-primary transition-colors leading-snug">${content.name}</h3>
                            <p class="text-gray-500 text-sm line-clamp-3 mb-6 leading-relaxed flex-grow">${content.desc}</p>
                            <div class="pt-4 border-t border-gray-50 flex justify-between items-center mt-auto">
                                <span class="text-xs font-semibold text-gray-400 group-hover:text-gray-600 transition">#${place.id.toString().padStart(4, '0')}</span>
                                <span class="w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-gray-400 group-hover:bg-primary group-hover:text-white transition-colors"><i class="fa-solid ${isRTL ? 'fa-arrow-left' : 'fa-arrow-right'} text-sm"></i></span>
                            </div>
                        </div>
                    </div>
                `;
            });
            html += `</div>`;
            app.innerHTML = html;
        }

        function renderDetail(id) {
            if (window.map && window.map.remove) { window.map.remove(); window.map = null; }

            const place = window.db.find(p => p.id === id);
            if (!place) return renderHome();

            window.currentGalleryImages = place.images;

            const app = document.getElementById('app');
            const texts = uiText[window.currentLang];
            const content = place.content[window.currentLang] || place.content['tr'];
            const isRTL = (window.currentLang === 'ar' || window.currentLang === 'osm');
            const descriptionHtml = content.detailDesc || `<p>${content.desc}</p>`;

            app.innerHTML = `
                <div class="fade-in max-w-6xl mx-auto px-2 lg:px-0">
                    <div class="mb-6 flex items-center justify-between">
                         <button onclick="router('home')" class="flex items-center text-gray-500 hover:text-primary transition font-semibold bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-100 hover:shadow-md">
                            <i class="fa-solid ${isRTL ? 'fa-arrow-right' : 'fa-arrow-left'} mr-2 rtl:mr-0 rtl:ml-2"></i> ${texts.back}
                        </button>
                        <div class="hidden md:block text-sm text-gray-400 font-mono">ID: #${place.id.toString().padStart(4, '0')}</div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                        <div class="lg:col-span-8 space-y-8">
                            <div class="relative h-[400px] md:h-[500px] rounded-2xl overflow-hidden shadow-lg group">
                                <img src="${place.images[0]}" onerror="this.src='https://via.placeholder.com/800x600?text=Gorsel+Yok'" referrerpolicy="no-referrer" class="w-full h-full object-cover cursor-pointer" onclick="openLightbox(0)">
                                <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent flex items-end p-8 pointer-events-none">
                                    <div class="w-full">
                                        <div class="flex items-center text-orange-200 text-sm font-bold uppercase tracking-wider mb-2"><i class="fa-solid fa-location-dot mr-2"></i> ${content.location}</div>
                                        <h1 class="text-3xl md:text-5xl font-bold text-white mb-2 shadow-sm leading-tight">${content.name}</h1>
                                    </div>
                                </div>
                            </div>
                            
                            ${content.audioUrl ? `
                            <div class="bg-white p-5 rounded-xl shadow-card border border-gray-100 flex flex-col md:flex-row items-center gap-4">
                                <div class="bg-orange-50 w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0 text-primary"><i class="fa-solid fa-headphones text-xl"></i></div>
                                <div class="flex-grow w-full md:w-auto text-center md:text-left rtl:md:text-right">
                                    <p class="text-xs text-primary font-bold uppercase tracking-wider mb-0.5 opacity-80">${texts.playAudio}</p>
                                    <h4 class="text-sm font-bold text-gray-800">${content.audioTitle}</h4>
                                </div>
                                <audio controls preload="auto" class="w-full md:w-64 h-10 rounded-lg bg-gray-50" src="${content.audioUrl}">
                                    Tarayıcınız ses elementini desteklemiyor.
                                </audio>
                            </div>` : ''}

                            <div class="bg-white p-8 rounded-2xl shadow-card border border-gray-100">
                                <h3 class="text-xl font-bold text-gray-800 mb-6 border-b border-gray-100 pb-4">Hakkında</h3>
                                <div class="leading-relaxed text-lg text-gray-600 text-justify detail-content font-light">${descriptionHtml}</div>
                            </div>
                        </div>
                        <div class="lg:col-span-4 space-y-6">
                            <div class="bg-white p-1 rounded-2xl shadow-card border border-gray-100 overflow-hidden">
                                <div class="p-4 border-b border-gray-50 flex justify-between items-center bg-gray-50/50">
                                    <h3 class="font-bold text-gray-800">${texts.location}</h3>
                                    <i class="fa-solid fa-map text-gray-400"></i>
                                </div>
                                <iframe src="${place.mapUrl}" width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                                <a href="${place.mapUrl.replace('embed', 'search')}" target="_blank" class="block text-center py-3 text-sm text-primary font-semibold hover:bg-gray-50 transition">Haritada Aç <i class="fa-solid fa-external-link-alt ml-1 text-xs"></i></a>
                            </div>
                            <div class="bg-white p-5 rounded-2xl shadow-card border border-gray-100">
                                <h3 class="font-bold text-gray-800 mb-4 flex items-center"><i class="fa-regular fa-images mr-2 text-primary"></i> ${texts.gallery}</h3>
                                <div class="grid grid-cols-2 gap-3">
                                    ${place.images.map((img, idx) => `<img src="${img}" onerror="this.src='https://via.placeholder.com/300?text=Gorsel+Yok'" referrerpolicy="no-referrer" class="rounded-lg h-24 w-full object-cover cursor-pointer hover:opacity-80 transition ring-2 ring-transparent hover:ring-primary/20" onclick="openLightbox(${idx})">`).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            const audioEl = document.querySelector('audio');
            if(audioEl) { audioEl.load(); }
        }

        function renderMap() {
            const container = document.getElementById('map-container');
            if(container) {
                container.innerHTML = ""; 
                container._leaflet_id = null; 
            }
            if (window.map) {
                window.map.remove();
                window.map = null;
            }

            const app = document.getElementById('app');
            const texts = uiText[window.currentLang];
            const isRTL = (window.currentLang === 'ar' || window.currentLang === 'osm');

            app.innerHTML = `
                <div class="fade-in h-full relative">
                    <div class="flex justify-between items-center mb-4 px-2">
                        <h2 class="text-2xl font-bold text-gray-800">${texts.menuMap}</h2>
                        <button onclick="router('home')" class="text-sm font-semibold text-primary hover:underline flex items-center">
                            <i class="fa-solid ${isRTL ? 'fa-arrow-right' : 'fa-arrow-left'} mr-1 rtl:mr-0 rtl:ml-1"></i> ${texts.back}
                        </button>
                    </div>
                    
                    <div class="absolute top-16 left-4 z-[100] w-64 md:w-80 shadow-lg">
                        <div class="relative">
                            <input type="text" id="mapSearchInput" placeholder="${texts.searchPlaceholder}" class="w-full py-3 px-4 rounded-lg shadow-md border border-gray-200 focus:ring-2 focus:ring-primary outline-none text-sm" onkeyup="filterMapMarkers()">
                            <i class="fa-solid fa-magnifying-glass absolute top-1/2 transform -translate-y-1/2 right-4 text-gray-400"></i>
                        </div>
                        <div id="mapSearchResults" class="bg-white mt-1 rounded-lg shadow-lg overflow-hidden hidden max-h-60 overflow-y-auto"></div>
                    </div>
                    
                    <div id="map-container" class="rounded-2xl shadow-xl overflow-hidden border border-gray-200 z-0"></div>
                </div>
            `;

            setTimeout(() => {
                window.map = L.map('map-container').setView([35.0, 38.0], 7);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; OpenStreetMap' }).addTo(window.map);
                window.mapMarkers = [];
                
                window.db.forEach(place => {
                    if(place.coords) {
                        const content = place.content[window.currentLang] || place.content['tr'];
                        const marker = L.marker(place.coords).addTo(window.map);
                        const popupContent = `
                            <div class="text-center p-2">
                                <h3 class="font-bold text-sm mb-2">${content.name}</h3>
                                <img src="${place.images[0]}" class="w-full h-24 object-cover rounded-md mb-2" onerror="this.src='https://via.placeholder.com/150'" referrerpolicy="no-referrer">
                                <button onclick="router('detail', ${place.id})" class="text-xs bg-primary text-white px-3 py-1 rounded hover:bg-orange-700 transition w-full">${texts.readMore}</button>
                            </div>`;
                        marker.bindPopup(popupContent);
                        marker.placeData = { id: place.id, name: content.name.toLowerCase() };
                        window.mapMarkers.push(marker);
                    }
                });
                if (window.mapMarkers.length > 0) window.map.fitBounds(new L.featureGroup(window.mapMarkers).getBounds().pad(0.1));
                
                window.map.invalidateSize();
            }, 300); 
        }

        // ... (Diğer fonksiyonlar aynı)
        function filterMapMarkers() {
            const input = document.getElementById('mapSearchInput');
            const filter = input.value.toLowerCase();
            const resultsContainer = document.getElementById('mapSearchResults');
            resultsContainer.innerHTML = '';
            if (filter.length < 1) { resultsContainer.classList.add('hidden'); return; }
            let hasResults = false;
            window.mapMarkers.forEach(marker => {
                if (marker.placeData.name.includes(filter)) {
                    hasResults = true;
                    const div = document.createElement('div');
                    div.className = 'p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-0 text-sm font-medium';
                    const place = window.db.find(p => p.id === marker.placeData.id);
                    const originalName = (place.content[window.currentLang] || place.content['tr']).name;
                    div.innerHTML = `<i class="fa-solid fa-location-dot text-primary mr-2"></i> ${originalName}`;
                    div.onclick = function() {
                        window.map.flyTo(marker.getLatLng(), 16);
                        marker.openPopup();
                        resultsContainer.classList.add('hidden');
                        input.value = originalName;
                    };
                    resultsContainer.appendChild(div);
                }
            });
            resultsContainer.classList.toggle('hidden', !hasResults);
            if (!hasResults) {
                resultsContainer.innerHTML = `<div class="p-3 text-gray-500 text-sm">Sonuç bulunamadı</div>`;
                resultsContainer.classList.remove('hidden');
            }
        }

        function setLanguage(lang) {
            window.currentLang = lang;
            const isRTL = (lang === 'ar' || lang === 'osm');
            document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
            document.documentElement.lang = lang;
            if (isRTL) { document.body.classList.add('font-arabic'); document.body.classList.remove('font-sans'); }
            else { document.body.classList.add('font-sans'); document.body.classList.remove('font-arabic'); }
            const flagImg = document.getElementById('current-lang-flag');
            if(flagImg && flags[lang]) { flagImg.src = flags[lang]; flagImg.alt = lang.toUpperCase(); }
            updateUIText();
            if (window.currentView === 'home') renderHome(); else if (window.currentView === 'map') renderMap(); else renderDetail(window.currentPlaceId);
        }

        function updateUIText() {
            const texts = uiText[window.currentLang];
            document.getElementById('nav-title').innerText = texts.siteName;
            document.getElementById('nav-subtitle').innerText = texts.siteSubtitle;
            document.getElementById('current-lang-label').innerText = window.currentLang.toUpperCase();
            document.getElementById('menu-home').innerText = texts.menuHome;
            document.getElementById('menu-map').innerText = texts.menuMap;
            document.getElementById('menu-about').innerText = texts.menuAbout;
            document.getElementById('menu-contact').innerText = texts.menuContact;
            document.getElementById('mobile-menu-home').innerText = texts.menuHome;
            document.getElementById('mobile-menu-map').innerText = texts.menuMap;
            document.getElementById('mobile-menu-about').innerText = texts.menuAbout;
            document.getElementById('mobile-menu-contact').innerText = texts.menuContact;
            if(window.currentLang === 'ar' || window.currentLang === 'osm') document.getElementById('footer-text').innerText = "© 2025 مشروع التراث السوري. جميع الحقوق محفوظة.";
            else document.getElementById('footer-text').innerText = "© 2025 Syrian Heritage Project. All rights reserved.";
        }

        function filterPlaces() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const cards = document.querySelectorAll('.card-item');
            cards.forEach(card => {
                const text = card.innerText.toLowerCase();
                if (text.includes(query)) card.style.display = 'flex'; else card.style.display = 'none';
            });
        }
    </script>
</body>
</html>